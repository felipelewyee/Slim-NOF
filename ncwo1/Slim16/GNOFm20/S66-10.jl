using DoNOF

mol = """
0 1
N         -1.453934135634    0.199944332888   -0.757715097449
H         -0.625338396930   -0.384909200688   -0.808057179042
H         -2.115761700754   -0.189715236660   -1.415952054177
C         -2.013951575915    0.120426538372    0.589663024499
H         -2.908030526802    0.738272676333    0.650883920854
H         -2.278038267596   -0.886815706602    0.927168615906
H         -1.295568295023    0.527702873085    1.298803730494
N          1.583600719117   -0.726493189723   -0.605239056236
H          1.879869389195   -0.451955454822   -1.533224299529
H          2.207150386084   -1.474183505751   -0.330044193261
C          1.743830695067    0.408717403161    0.308436247873
H          1.473640390979    0.094021622922    1.314089356636
H          2.751241006206    0.830493962319    0.345407981528
H          1.051290312165    1.194492885167    0.015779001903
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "S66-10"

p.ipnof = 8
p.ista = 1
p.h_cut = 0.020 * sqrt(2)

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)

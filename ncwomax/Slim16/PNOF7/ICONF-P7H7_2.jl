using DoNOF

mol = """
0 1
   P         -0.58377870      1.77700045      0.86650155
   P         -2.40538924      1.06487699     -0.23552906
   P         -1.96126900     -1.06438439     -0.61807224
   P         -0.49247160     -1.66556340      0.96426263
   P          1.32347170     -1.83042367     -0.34119624
   P          2.24804540      0.11350010      0.29757379
   P          0.82407948      1.42744844     -0.84746708
   H         -0.77769310      3.14166853      0.50660999
   H         -3.16217444      0.78130373      0.93366898
   H         -1.03676937     -0.80487803     -1.66373229
   H         -0.78715490     -3.05038878      0.82711281
   H          2.05078396     -2.57323926      0.63574519
   H          3.17817045      0.09118803     -0.78444646
   H          1.58214938      2.59189126     -0.54103159
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "ICONF-P7H7_2"

p.ipnof = 7

p.RI = true
p.maxit = 40

p.maxloop = 10

#DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)

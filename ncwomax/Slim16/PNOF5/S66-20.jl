using DoNOF

mol = """
0 1
C         -1.925503392979    0.094535350524    0.009606827599
O         -1.221955305202    1.067853391500    0.249359492955
O         -1.453097704793   -1.107687463466   -0.278664362327
H         -0.459358530173   -1.074882600585   -0.264041337010
C         -3.422221987264    0.139944601618    0.013804144586
H         -3.759792166870    1.144858780501    0.235863164847
H         -3.796683467171   -0.180214770142   -0.955448726022
H         -3.801006148894   -0.557694788202    0.757103908734
C          1.925554258079   -0.094185979290   -0.011269416946
O          1.221935892917   -1.067500467370   -0.251057019112
O          1.453127924041    1.108249408375    0.276509053928
H          0.459339384064    1.075351174814    0.262108549761
C          3.422266705970   -0.140088725211   -0.013233812323
H          3.759846270005   -1.141407918348   -0.250759307168
H          3.803765251074    0.570264213621   -0.742702709916
H          3.793783017091    0.162605791768    0.962821548733
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "S66-20"

p.ipnof = 5

p.RI = true
p.maxit = 40

p.maxloop = 10

#DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)

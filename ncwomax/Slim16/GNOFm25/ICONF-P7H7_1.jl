using DoNOF

mol = """
0 1
   P         -0.68936551      1.71916200      0.60819426
   P         -2.00484346      0.69600963     -0.88997109
   P         -2.13712049     -1.41228726     -0.25124589
   P         -0.24325714     -1.73109333      0.91328671
   P          1.14923927     -1.39271720     -0.80646175
   P          2.39478337      0.27126694     -0.00721071
   P          1.11631679      1.94426317     -0.69720412
   H         -1.19153359      3.01092800      0.27862672
   H         -1.02557808      0.45449412     -1.88930564
   H         -2.93631095     -1.10363541      0.88277532
   H         -0.24435159     -3.14367828      0.71944824
   H          2.05312063     -2.39736379     -0.36920284
   H          1.98893835      0.20427601      1.35411318
   H          1.76996240      2.88037539      0.15415762
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "ICONF-P7H7_1"

p.ipnof = 8
p.ista = 1
p.h_cut = 0.025 * sqrt(2)

p.RI = true
p.maxit = 40

p.maxloop = 10

#DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)

using DoNOF

mol = """
0 1
N          0.000441749282   -1.305081978272   -0.044115233278
H         -0.001420775188   -2.314804375408    0.000927357727
C         -1.258064387019   -0.692236054124   -0.118711730184
O         -2.273001323749   -1.364991942242   -0.177228242398
C         -1.192463455123    0.758960833609   -0.120634113651
H         -2.108454053101    1.318241903640   -0.201227949355
C          0.002815216136    1.374336409688   -0.019930098380
H          0.104005861217    2.449338788485   -0.010705831429
N          1.171821601279    0.670499997570    0.081043420461
H          2.052550472775    1.140188686559    0.207494781774
C          1.231242317070   -0.710895773141    0.122040647780
O          2.270526776262   -1.323556496365    0.281046990773
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "S66-32A"

p.ipnof = 8

p.RI = true
p.maxit = 40

p.maxloop = 10

#DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)

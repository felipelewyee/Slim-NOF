using DoNOF

mol = """
0 1
N         -0.046853011732   -1.219460522718   -0.862079765394
H         -0.048715536255   -2.229182919854   -0.817037174335
C         -1.305359148085   -0.606614598570   -0.936676262300
O         -2.320296084816   -1.279370486688   -0.995192774514
C         -1.239758216190    0.844582289110   -0.938598645767
H         -2.155748814168    1.403863359141   -1.019192481471
C         -0.044479544879    1.459957865189   -0.837894630495
H          0.056711100150    2.534960243986   -0.828670363544
N          1.124526840212    0.756121453071   -0.736921111602
H          2.005255711708    1.225810142060   -0.610469750289
C          1.183947556003   -0.625274317587   -0.695923884283
O          2.223232015195   -1.237935040810   -0.536917541290
C          0.716452397198   -0.443771831652    2.404261316390
H          1.712270666892   -0.797757684830    2.290042586219
C         -0.428151688177   -0.057314145886    2.510453158496
H         -1.433034242898    0.271386196408    2.610817324496
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "S66-32"

p.ipnof = 8
p.ista = 1
p.h_cut = 0.020 * sqrt(2)

p.RI = true
p.maxit = 40

p.maxloop = 10

#DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
